@page "/useradd"
@using ASM_NhomSugar_SD19311.Model
@inject HttpClient Http
@inject NavigationManager Nav
@using Microsoft.AspNetCore.Components.Forms

<h3 class="mb-4 text-xl font-bold">➕ Thêm người dùng</h3>

<EditForm Model="@user" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label class="block font-medium">Tên đầy đủ</label>
        <InputText class="w-full rounded border px-3 py-2" @bind-Value="user.FullName" />
    </div>
    <div class="mb-3">
        <label class="block font-medium">Số điện thoại</label>
        <InputText class="w-full rounded border px-3 py-2" @bind-Value="user.Phone" />
    </div>
    <div class="mb-3">
        <label class="block font-medium">Địa chỉ</label>
        <InputText class="w-full rounded border px-3 py-2" @bind-Value="user.Address" />
    </div>
    <div class="mb-3">
        <label class="block font-medium">ID Tài khoản</label>
        <InputNumber class="w-full rounded border px-3 py-2" @bind-Value="user.AccountId" />
    </div>

    <div class="mt-4 flex space-x-3">
        <button type="submit" class="rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700">Lưu</button>
        <button type="button" class="rounded bg-gray-400 px-4 py-2 text-white hover:bg-gray-500" @onclick="() => Nav.NavigateTo(" /user")">Quay lại</button>
    </div>
</EditForm>

@code {
    private Users user = new Users();

    private async Task HandleValidSubmit()
    {
        var response = await Http.PostAsJsonAsync("https://localhost:44366/api/user", user);
        if (response.IsSuccessStatusCode)
        {
            Nav.NavigateTo("/user");
        }
        else
        {
            Console.WriteLine("Thêm thất bại: " + await response.Content.ReadAsStringAsync());
        }
    }
}
